"use strict";(self.webpackChunkahnlich_web=self.webpackChunkahnlich_web||[]).push([[5096],{28453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>l});var i=s(96540);const r={},t=i.createContext(r);function c(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:n},e.children)}},84333:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>a,frontMatter:()=>c,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"components/persistence-in-ahnlich/persistence-for-ahnlich-db","title":"Persistence for Ahnlich DB","description":"Why need persistence?","source":"@site/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-db.md","sourceDirName":"components/persistence-in-ahnlich","slug":"/components/persistence-in-ahnlich/persistence-for-ahnlich-db","permalink":"/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-db","draft":false,"unlisted":false,"editUrl":"https://github.com/deven96/ahnlich/tree/main/web/ahnlich-web/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-db.md","tags":[],"version":"current","sidebarPosition":30,"frontMatter":{"title":"Persistence for Ahnlich DB","sidebar_position":30},"sidebar":"docsSidebar","previous":{"title":"\u267e\ufe0f Persistence In Ahnlich","permalink":"/docs/components/persistence-in-ahnlich/"},"next":{"title":"Persistence for Ahnlich AI","permalink":"/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-ai"}}');var r=s(74848),t=s(28453);const c={title:"Persistence for Ahnlich DB",sidebar_position:30},l="Persistence for Ahnlich DB",o={},d=[{value:"Why need persistence?",id:"why-need-persistence",level:3},{value:"Configuring persistence from in-memory mode to disk",id:"configuring-persistence-from-in-memory-mode-to-disk",level:3},{value:"Loading from persistence",id:"loading-from-persistence",level:3}];function h(e){const n={code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"persistence-for-ahnlich-db",children:"Persistence for Ahnlich DB"})}),"\n",(0,r.jsx)(n.h3,{id:"why-need-persistence",children:"Why need persistence?"}),"\n",(0,r.jsx)(n.p,{children:"Ahnlich DB manages structured data like keys, values, and predicates. Running it in-memory only means:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Stored data disappears after restarts."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Predicate indexes must be rebuilt manually."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Any production state is volatile."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Enabling persistence ensures:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Data and indexes survive restarts or container upgrades."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Your stores can be backed up and restored easily."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Mission-critical applications don\u2019t lose their data."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuring-persistence-from-in-memory-mode-to-disk",children:"Configuring persistence from in-memory mode to disk"}),"\n",(0,r.jsx)(n.p,{children:"Enable persistence by starting the DB service with persistence flags:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'ahnlich_db:\n  image: ghcr.io/deven96/ahnlich-db:latest\n  command: >\n    "ahnlich-db run --host 0.0.0.0 \\\n    --enable-persistence --persist-location /root/.ahnlich/data/db.dat \\\n    --persistence-interval 300"\n  ports:\n    - "1369:1369"\n  volumes:\n    - "./data/:/root/.ahnlich/data" # Persistence Location\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--enable-persistence"})," \u2192 turns on persistence."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--persist-location"})," \u2192 file path to store snapshots (e.g., ",(0,r.jsx)(n.code,{children:"db.dat"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--persistence-interval"})," \u2192 snapshot interval in seconds (default: 300)."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"volumes"})," \u2192 ensures snapshots persist outside container lifecycle."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"loading-from-persistence",children:"Loading from persistence"}),"\n",(0,r.jsxs)(n.p,{children:["When restarted, the DB automatically loads the latest snapshot from ",(0,r.jsx)(n.code,{children:"db.dat"}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"All stores, keys, and predicates return to their previous state."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"No manual re-indexing is required."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"You can back up or restore DB state simply by copying the persistence file."}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}}}]);