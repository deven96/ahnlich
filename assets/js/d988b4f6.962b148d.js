"use strict";(self.webpackChunkahnlich_web=self.webpackChunkahnlich_web||[]).push([[4596],{6599:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>a,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"components/persistence-in-ahnlich/persistence-for-ahnlich-ai","title":"Persistence for Ahnlich AI","description":"Why need persistence?","source":"@site/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-ai.md","sourceDirName":"components/persistence-in-ahnlich","slug":"/components/persistence-in-ahnlich/persistence-for-ahnlich-ai","permalink":"/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-ai","draft":false,"unlisted":false,"editUrl":"https://github.com/deven96/ahnlich/tree/main/web/ahnlich-web/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-ai.md","tags":[],"version":"current","sidebarPosition":30,"frontMatter":{"title":"Persistence for Ahnlich AI","sidebar_position":30},"sidebar":"docsSidebar","previous":{"title":"Persistence for Ahnlich DB","permalink":"/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-db"},"next":{"title":"Distributed Tracing","permalink":"/docs/components/distributed-tracing/"}}');var r=s(74848),c=s(28453);const t={title:"Persistence for Ahnlich AI",sidebar_position:30},o="Persistence for Ahnlich AI",l={},d=[{value:"Why need persistence?",id:"why-need-persistence",level:3},{value:"Configuring persistence from in-memory mode to disk",id:"configuring-persistence-from-in-memory-mode-to-disk",level:3},{value:"Loading from persistence",id:"loading-from-persistence",level:3}];function h(e){const n={code:"code",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"persistence-for-ahnlich-ai",children:"Persistence for Ahnlich AI"})}),"\n",(0,r.jsx)(n.h3,{id:"why-need-persistence",children:"Why need persistence?"}),"\n",(0,r.jsx)(n.p,{children:"Ahnlich AI builds on DB by adding embeddings, vector similarity search, and model-driven queries. Without persistence:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"AI stores and embeddings vanish after restarts."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Indices must be recomputed, delaying queries."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Models re-download weights on each startup."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Persistence ensures that:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Embeddings and indices survive container restarts."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Models remain cached locally for faster startup."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Production workloads avoid costly recomputation."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"configuring-persistence-from-in-memory-mode-to-disk",children:"Configuring persistence from in-memory mode to disk"}),"\n",(0,r.jsx)(n.p,{children:"Enable persistence for AI with the following configuration:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'ahnlich_ai:\n  image: ghcr.io/deven96/ahnlich-ai:latest\n  command: >\n    "ahnlich-ai run --db-host ahnlich_db --host 0.0.0.0 \\\n    --supported-models all-minilm-l6-v2,resnet-50 \\\n    --enable-persistence --persist-location /root/.ahnlich/data/ai.dat \\\n    --persistence-interval 300"\n  ports:\n    - "1370:1370"\n  volumes:\n    - "./ahnlich_ai_model_cache:/root/.ahnlich/models" # Model cache storage\n    - "./data/:/root/.ahnlich/data" # Persistence Location\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--enable-persistence"})," \u2192 activates persistence for embeddings and AI stores."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--persist-location"})," \u2192 file path for AI persistence (e.g., ",(0,r.jsx)(n.code,{children:"ai.dat"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"--persistence-interval"})," \u2192 interval (in seconds) for saving snapshots."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"./ahnlich_ai_model_cache"})," \u2192 stores model weights persistently."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"./data/"})," \u2192 keeps AI persistence files safe."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"loading-from-persistence",children:"Loading from persistence"}),"\n",(0,r.jsxs)(n.p,{children:["On restart, Ahnlich AI automatically restores state from ",(0,r.jsx)(n.code,{children:"ai.dat"}),"."]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"All embeddings, similarity indices, and AI stores are reloaded."}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Cached models are loaded from ",(0,r.jsx)(n.code,{children:"./ahnlich_ai_model_cache"}),", avoiding redownloads."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Commands like ",(0,r.jsx)(n.code,{children:"LISTSTORES"}),", ",(0,r.jsx)(n.code,{children:"GETSIMN"}),", and ",(0,r.jsx)(n.code,{children:"GETPRED"})," can confirm successful recovery."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Recovery from backups is as easy as restoring the persistence file and model cache."}),"\n"]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>o});var i=s(96540);const r={},c=i.createContext(r);function t(e){const n=i.useContext(c);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);