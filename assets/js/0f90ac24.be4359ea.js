"use strict";(self.webpackChunkahnlich_web=self.webpackChunkahnlich_web||[]).push([[5392],{3298:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"components/predicates/predicates","title":"\ud83d\udd0d Predicates","description":"Predicates in Ahnlich are metadata-based filters that allow you to query and filter stored data beyond just similarity search. They work alongside vector similarity to enable powerful hybrid queries.","source":"@site/docs/components/predicates/predicates.md","sourceDirName":"components/predicates","slug":"/components/predicates/","permalink":"/docs/components/predicates/","draft":false,"unlisted":false,"editUrl":"https://github.com/deven96/ahnlich/tree/main/web/ahnlich-web/docs/components/predicates/predicates.md","tags":[],"version":"current","sidebarPosition":40,"frontMatter":{"title":"\ud83d\udd0d Predicates","sidebar_position":40},"sidebar":"docsSidebar","previous":{"title":"Persistence for Ahnlich AI","permalink":"/docs/components/persistence-in-ahnlich/persistence-for-ahnlich-ai"},"next":{"title":"Quick Reference","permalink":"/docs/components/predicates/quick-reference"}}');var t=n(74848),d=n(28453);const s={title:"\ud83d\udd0d Predicates",sidebar_position:40},c="Predicates",l={},a=[{value:"Overview",id:"overview",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"Predicate",id:"predicate",level:3},{value:"Predicate Condition",id:"predicate-condition",level:3},{value:"Predicate Index",id:"predicate-index",level:3},{value:"Supported Data Types",id:"supported-data-types",level:2},{value:"Examples",id:"examples",level:2},{value:"Simple Predicate Query",id:"simple-predicate-query",level:3},{value:"Complex Condition",id:"complex-condition",level:3},{value:"Hybrid Query (Similarity + Predicate)",id:"hybrid-query-similarity--predicate",level:3},{value:"Using IN Operator",id:"using-in-operator",level:3},{value:"Delete by Predicate",id:"delete-by-predicate",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"1. Create Indexes for Frequently Queried Fields",id:"1-create-indexes-for-frequently-queried-fields",level:3},{value:"2. Declare Predicates at Store Creation",id:"2-declare-predicates-at-store-creation",level:3},{value:"3. Keep Metadata Lightweight",id:"3-keep-metadata-lightweight",level:3},{value:"4. Use AND/OR Efficiently",id:"4-use-andor-efficiently",level:3},{value:"5. Index High-Cardinality Fields",id:"5-index-high-cardinality-fields",level:3},{value:"CLI Command Reference",id:"cli-command-reference",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Advanced: Predicate Internals",id:"advanced-predicate-internals",level:2}];function o(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"predicates",children:"Predicates"})}),"\n",(0,t.jsxs)(i.p,{children:["Predicates in Ahnlich are ",(0,t.jsx)(i.strong,{children:"metadata-based filters"})," that allow you to query and filter stored data beyond just similarity search. They work alongside vector similarity to enable powerful hybrid queries."]}),"\n",(0,t.jsx)(i.h2,{id:"overview",children:"Overview"}),"\n",(0,t.jsx)(i.p,{children:"When you store data in Ahnlich (both DB and AI), each entry consists of:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Key"}),": The vector embedding (or raw key for DB stores)"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Value"}),": Metadata as key-value pairs (e.g., ",(0,t.jsx)(i.code,{children:'{"author": "Alice", "category": "tech"}'}),")"]}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"Predicates let you filter results based on this metadata."}),"\n",(0,t.jsx)(i.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,t.jsx)(i.h3,{id:"predicate",children:"Predicate"}),"\n",(0,t.jsxs)(i.p,{children:["A ",(0,t.jsx)(i.strong,{children:"predicate"})," is a single comparison operation on a metadata field. Ahnlich supports four operators:"]}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Operator"}),(0,t.jsx)(i.th,{children:"Description"}),(0,t.jsx)(i.th,{children:"Example"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"EQUALS"})}),(0,t.jsx)(i.td,{children:"Exact match"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:'author = "Alice"'})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"NOT EQUALS"})}),(0,t.jsx)(i.td,{children:"Not equal"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:'status != "draft"'})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"IN"})}),(0,t.jsx)(i.td,{children:"Value in list"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:'category IN ["tech", "science"]'})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"NOT IN"})}),(0,t.jsx)(i.td,{children:"Value not in list"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:'priority NOT IN ["low", "spam"]'})})]})]})]}),"\n",(0,t.jsx)(i.h3,{id:"predicate-condition",children:"Predicate Condition"}),"\n",(0,t.jsxs)(i.p,{children:["A ",(0,t.jsx)(i.strong,{children:"predicate condition"})," combines predicates using logical operators:"]}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Operator"}),(0,t.jsx)(i.th,{children:"Description"}),(0,t.jsx)(i.th,{children:"Example"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"AND"})}),(0,t.jsx)(i.td,{children:"Both conditions must be true"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:'(author = "Alice") AND (category = "tech")'})})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"OR"})}),(0,t.jsx)(i.td,{children:"Either condition must be true"}),(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:'(status = "published") OR (priority = "high")'})})]})]})]}),"\n",(0,t.jsx)(i.p,{children:"Conditions can be nested to create complex queries:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'(author = "Alice" AND category = "tech") OR (priority = "high")\n'})}),"\n",(0,t.jsx)(i.h3,{id:"predicate-index",children:"Predicate Index"}),"\n",(0,t.jsxs)(i.p,{children:["A ",(0,t.jsx)(i.strong,{children:"predicate index"})," optimizes queries on specific metadata fields. Without an index, Ahnlich scans all entries. With an index, lookups are much faster."]}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"Creating an index:"})}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"CREATEPREDINDEX author, category IN my_store\n"})}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"Dropping an index:"})}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"DROPPREDINDEX category IN my_store\n"})}),"\n",(0,t.jsx)(i.p,{children:"Indexes are idempotent - creating an existing index won't error, it just adds new ones."}),"\n",(0,t.jsx)(i.h2,{id:"supported-data-types",children:"Supported Data Types"}),"\n",(0,t.jsx)(i.p,{children:"Predicates work with metadata values of type:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"String"})," - Text values like ",(0,t.jsx)(i.code,{children:'"Alice"'}),", ",(0,t.jsx)(i.code,{children:'"tech"'}),", ",(0,t.jsx)(i.code,{children:'"published"'})]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Binary"})," - Raw bytes (for image hashes, etc.)"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(i.h3,{id:"simple-predicate-query",children:"Simple Predicate Query"}),"\n",(0,t.jsx)(i.p,{children:'Find all entries where author is "Alice":'}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'GETPRED (author = "Alice") IN my_store\n'})}),"\n",(0,t.jsx)(i.h3,{id:"complex-condition",children:"Complex Condition"}),"\n",(0,t.jsx)(i.p,{children:"Find tech articles by Alice or Bob:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'GETPRED ((author = "Alice") OR (author = "Bob")) AND (category = "tech") IN my_store\n'})}),"\n",(0,t.jsx)(i.h3,{id:"hybrid-query-similarity--predicate",children:"Hybrid Query (Similarity + Predicate)"}),"\n",(0,t.jsx)(i.p,{children:"Find similar documents, filtered by author:"}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"Ahnlich AI:"})}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'GETSIMN 5 WITH [machine learning tutorial] USING cosinesimilarity IN my_store WHERE (author = "Alice")\n'})}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"Ahnlich DB:"})}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'GETSIMN 5 WITH [0.1, 0.2, ...] USING cosinesimilarity IN my_store WHERE (author = "Alice")\n'})}),"\n",(0,t.jsx)(i.p,{children:"This combines vector similarity with metadata filtering."}),"\n",(0,t.jsx)(i.h3,{id:"using-in-operator",children:"Using IN Operator"}),"\n",(0,t.jsx)(i.p,{children:"Find entries with multiple allowed values:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'GETPRED category IN ["tech", "science", "ai"] IN my_store\n'})}),"\n",(0,t.jsx)(i.h3,{id:"delete-by-predicate",children:"Delete by Predicate"}),"\n",(0,t.jsx)(i.p,{children:"Remove all draft entries:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:'DELPRED (status = "draft") IN my_store\n'})}),"\n",(0,t.jsx)(i.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,t.jsx)(i.h3,{id:"1-create-indexes-for-frequently-queried-fields",children:"1. Create Indexes for Frequently Queried Fields"}),"\n",(0,t.jsxs)(i.p,{children:["If you often filter by ",(0,t.jsx)(i.code,{children:"author"}),", create an index:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"CREATEPREDINDEX author IN my_store\n"})}),"\n",(0,t.jsx)(i.h3,{id:"2-declare-predicates-at-store-creation",children:"2. Declare Predicates at Store Creation"}),"\n",(0,t.jsx)(i.p,{children:"Specify expected predicates upfront:"}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"Ahnlich AI:"})}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"CREATESTORE my_store \n  QUERYMODEL all-minilm-l6-v2 \n  INDEXMODEL all-minilm-l6-v2 \n  PREDICATES (author, category, status)\n"})}),"\n",(0,t.jsx)(i.p,{children:(0,t.jsx)(i.strong,{children:"Ahnlich DB:"})}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"CREATESTORE my_store \n  DIMENSION 384 \n  CREATEPREDINDEX (author, category, status)\n"})}),"\n",(0,t.jsx)(i.h3,{id:"3-keep-metadata-lightweight",children:"3. Keep Metadata Lightweight"}),"\n",(0,t.jsx)(i.p,{children:"Predicates are for filtering, not bulk data storage. Keep values small:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["\u2705 Good: ",(0,t.jsx)(i.code,{children:'{"author": "Alice", "category": "tech"}'})]}),"\n",(0,t.jsxs)(i.li,{children:["\u274c Bad: ",(0,t.jsx)(i.code,{children:'{"content": "<entire article text>"}'})]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"4-use-andor-efficiently",children:"4. Use AND/OR Efficiently"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Use ",(0,t.jsx)(i.code,{children:"AND"})," when both conditions must match (narrows results)"]}),"\n",(0,t.jsxs)(i.li,{children:["Use ",(0,t.jsx)(i.code,{children:"OR"})," when either condition matches (broadens results)"]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"5-index-high-cardinality-fields",children:"5. Index High-Cardinality Fields"}),"\n",(0,t.jsxs)(i.p,{children:["If a field has many unique values (like ",(0,t.jsx)(i.code,{children:"author"}),"), index it. Low-cardinality fields (like ",(0,t.jsx)(i.code,{children:"status"})," with only 2-3 values) benefit less from indexing."]}),"\n",(0,t.jsx)(i.h2,{id:"cli-command-reference",children:"CLI Command Reference"}),"\n",(0,t.jsxs)(i.table,{children:[(0,t.jsx)(i.thead,{children:(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.th,{children:"Command"}),(0,t.jsx)(i.th,{children:"Description"})]})}),(0,t.jsxs)(i.tbody,{children:[(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"CREATEPREDINDEX"})}),(0,t.jsx)(i.td,{children:"Create index on metadata fields"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"DROPPREDINDEX"})}),(0,t.jsx)(i.td,{children:"Remove index from fields"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"GETPRED"})}),(0,t.jsx)(i.td,{children:"Query by predicate only"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"GETSIMN ... WHERE"})}),(0,t.jsx)(i.td,{children:"Similarity search filtered by predicate"})]}),(0,t.jsxs)(i.tr,{children:[(0,t.jsx)(i.td,{children:(0,t.jsx)(i.code,{children:"DELPRED"})}),(0,t.jsx)(i.td,{children:"Delete entries matching predicate"})]})]})]}),"\n",(0,t.jsx)(i.p,{children:"See detailed examples in:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"../ahnlich-cli/ai-commands",children:"AI CLI Commands"})}),"\n",(0,t.jsx)(i.li,{children:(0,t.jsx)(i.a,{href:"../ahnlich-cli/db-commands",children:"DB CLI Commands"})}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"limitations",children:"Limitations"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Predicates only support ",(0,t.jsx)(i.strong,{children:"equality-based comparisons"})," (no regex, range queries, or full-text search yet)"]}),"\n",(0,t.jsxs)(i.li,{children:["Index updates are ",(0,t.jsx)(i.strong,{children:"synchronous"})," - creating an index on a large store may take time"]}),"\n",(0,t.jsxs)(i.li,{children:["No support for ",(0,t.jsx)(i.strong,{children:"numeric comparisons"})," (e.g., ",(0,t.jsx)(i.code,{children:"age > 18"}),") - use string equality as a workaround"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"advanced-predicate-internals",children:"Advanced: Predicate Internals"}),"\n",(0,t.jsx)(i.p,{children:"Under the hood, predicates are structured as:"}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{children:"PredicateCondition:\n  - Value(Predicate)      // Single predicate\n  - And(left, right)      // Logical AND\n  - Or(left, right)       // Logical OR\n\nPredicate:\n  - Equals(key, value)\n  - NotEquals(key, value)\n  - In(key, [values])\n  - NotIn(key, [values])\n"})}),"\n",(0,t.jsx)(i.p,{children:"This structure allows nesting and complex boolean logic while keeping the implementation efficient."})]})}function h(e={}){const{wrapper:i}={...(0,d.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(o,{...e})}):o(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>c});var r=n(96540);const t={},d=r.createContext(t);function s(e){const i=r.useContext(d);return r.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(d.Provider,{value:i},e.children)}}}]);